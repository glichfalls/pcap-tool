import{l as R,B as b}from"./entry.a3fa48b6.js";const d=()=>{const{public:{apiUrl:n}}=R(),o={"Content-Type":"application/json"};return{get:async(i,t={})=>{const e=new URLSearchParams(t).toString();return await $fetch(`${i}?${e}`,{baseURL:n,headers:o})},post:(i,t={})=>$fetch(i,{method:"POST",baseURL:n,body:t,headers:o}),put:(i,t={})=>$fetch(i,{method:"PUT",baseURL:n,body:t,headers:o}),httpDelete:i=>$fetch(i,{method:"DELETE",baseURL:n,headers:o})}},g=()=>{const{get:n,post:o,put:l}=d(),c=b("filter",()=>null),p=async()=>{var t,e,s,a,u,m,_,f,h,y;try{const r=await n("/api/filter");c.value={name:(r==null?void 0:r.name)||"",description:(r==null?void 0:r.description)||"",ips:((a=(s=(e=(t=r==null?void 0:r.criteria)==null?void 0:t.ipv4_dst)==null?void 0:e[0])==null?void 0:s.addr)==null?void 0:a.join(","))||"",ports:((_=(m=(u=r==null?void 0:r.criteria)==null?void 0:u.layer4_dst_port)==null?void 0:m[0])==null?void 0:_.port)||"",vlan:((y=(h=(f=r==null?void 0:r.criteria)==null?void 0:f.vlan)==null?void 0:h[0])==null?void 0:y.vlan_id)||""}}catch(r){c.value={name:"",description:"",ips:"",ports:"",vlan:""}}};return{filter:c,reloadFilter:p,updateFilter:async t=>{try{const e={mode:"PASS_BY_CRITERIA",criteria:{logical_operation:"AND"}};if(e.criteria&&(t.ips||t.ports||t.vlan)){if(t.ips){const s=t.ips.split(",").map(a=>a.trim());e.criteria.ipv4_dst=[{addr:s}]}t.ports&&(e.criteria.layer4_dst_port=[{port:t.ports}]),t.vlan&&(e.criteria.vlan=[{vlan_id:t.vlan}])}await l("/api/filter",e),await p()}catch(e){console.error(e)}},measure:async()=>{var t;try{const e=await o("/api/measure"),s=(t=e==null?void 0:e.stats_snapshot)==null?void 0:t[0];return{status:e!==null?"Operational":"Down",passRate:s==null?void 0:s.df_current_pass_rate_bits,time:s==null?void 0:s.stats_time}}catch(e){return console.error(e),{status:"Down",passRate:null,time:null}}}}};export{g as a,d as u};
