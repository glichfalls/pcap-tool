import{a as m,r as v,o as _,c as u,w as b,b as i,u as c,i as R,e as S,f as I,h as L,j as f,F as N,k as F,t as g,l as V,m as h,p as B,q as $,s as r,v as P,x as z,y as A}from"./entry.a3fa48b6.js";import{u as M,a as k}from"./usePacketBroker.4513fa92.js";const x=()=>{const{get:a,post:t}=M();return{listRecordings:async()=>{try{return await a("/api/recording/list")}catch(e){return""}},startRecording:async e=>{try{return await t("/api/recording/start",{duration:Number((e==null?void 0:e.duration)||0),size:Number((e==null?void 0:e.size)||0)}),!0}catch(d){console.error(d)}},stopRecording:()=>{},generateTraffic:async()=>await t("/api/traffic/generate")}},T=m({__name:"filterForm",setup(a){const{filter:t,updateFilter:n}=k();return(p,s)=>{const o=v("form-kit");return _(),u(o,{type:"form",modelValue:c(t),"onUpdate:modelValue":s[0]||(s[0]=e=>R(t)?t.value=e:null),"submit-label":"Save",onSubmit:c(n)},{default:b(()=>[i(o,{type:"text",name:"ports",label:"Ports",validation:"ports","validation-visibility":"live",help:"List of Ports (comma separated, ranges - separated)"}),i(o,{type:"text",name:"vlan",label:"VLAN",validation:"vlan","validation-visibility":"live",help:"List of VLAN ids (comma separated, ranges - separated)"}),i(o,{type:"textarea",rows:"20",name:"ips",label:"IP Addresses",validation:"ips","validation-visibility":"live",help:"List of IP v4 Addresses or CIDR notations (comma separated, ranges - separated)"})]),_:1},8,["modelValue","onSubmit"])}}}),D=m({__name:"recordingForm",setup(a){const{startRecording:t}=x();return(n,p)=>{const s=v("form-kit");return _(),u(s,{type:"form","submit-label":"Start",onSubmit:c(t)},{default:b(()=>[i(s,{type:"text",name:"size",label:"Max Size",validation:"number","validation-visibility":"live",help:"Max pcap size in MB"}),i(s,{type:"text",name:"duration",label:"Max duration",validation:"number","validation-visibility":"live",help:"Max duration in seconds"})]),_:1},8,["onSubmit"])}}}),U={class:"list"},j=["onClick"],E=m({__name:"pcapList",setup(a){const{listRecordings:t}=x(),n=S(""),p=I(()=>n.value.split(`
`).filter(e=>e.endsWith(".pcap"))),s=e=>{const{public:{apiUrl:d}}=V(),l=e.replace(".pcap","");window.open(`${d}/api/recording/download/${l}`)},o=setInterval(async()=>{n.value=await t()},5e3);return L(()=>{clearInterval(o)}),(e,d)=>(_(),f("div",U,[(_(!0),f(N,null,F(c(p),l=>(_(),f("div",{class:"item",onClick:()=>s(l)},g(l),9,j))),256))]))}});const q=h(E,[["__scopeId","data-v-b47f5333"]]),w=a=>(z("data-v-c7551019"),a=a(),A(),a),G={class:"actions"},H={class:"flex items-start justify-between gap-4"},W={class:"box w-1/4"},J={class:"box-title"},K={class:"box w-1/4"},O=w(()=>r("h2",{class:"box-title"}," Start Recording ",-1)),Q={class:"box w-2/4"},X=w(()=>r("h2",{class:"box-title"}," Downloads ",-1)),Y=m({__name:"index",async setup(a){let t,n;const{generateTraffic:p}=x(),{filter:s,reloadFilter:o}=k();return[t,n]=B(()=>o()),await t,n(),(e,d)=>{const l=v("form-kit"),C=$;return _(),u(C,{name:"page"},{default:b(()=>{var y;return[r("div",G,[i(l,{type:"button",label:"Generate Traffic",onClick:c(p)},null,8,["onClick"]),i(l,{type:"button",label:"Reload Filter",onClick:c(o)},null,8,["onClick"])]),r("div",H,[r("div",W,[r("h2",J," Edit Filter "+g((y=c(s))==null?void 0:y.name),1),c(s)?(_(),u(T,{key:0})):P("",!0)]),r("div",K,[O,i(D)]),r("div",Q,[X,i(q)])])]}),_:1})}}});const te=h(Y,[["__scopeId","data-v-c7551019"]]);export{te as default};
