import{a as m,r as f,o as d,c as v,w as b,b as i,u as p,i as I,e as h,f as u,h as L,t as g,j as w,k as N,l as V,F as $,m as F,p as B,q as k,s as P,v as z,x as _,y as A,z as M}from"./entry.ca7c75b3.js";import{u as T,a as R}from"./usePacketBroker.19fbcf0c.js";const y=()=>{const{get:l,post:t}=T();return{listRecordings:async()=>{try{return await l("/api/recording/list")}catch(e){return""}},startRecording:async e=>{try{return(await t("/api/recording/start",{duration:Number((e==null?void 0:e.duration)||0),size:Number((e==null?void 0:e.size)||0)})).message}catch(s){return console.error(s),null}},stopRecording:async e=>{try{return(await t(`/api/recording/${e}/stop`)).message}catch(s){return console.error(s),null}},generateTraffic:async()=>await t("/api/traffic/generate")}},D=m({__name:"filterForm",setup(l){const{filter:t,updateFilter:r}=R();return(a,c)=>{const o=f("form-kit");return d(),v(o,{type:"form",modelValue:p(t),"onUpdate:modelValue":c[0]||(c[0]=e=>I(t)?t.value=e:null),"submit-label":"Save",onSubmit:p(r)},{default:b(()=>[i(o,{type:"text",name:"ports",label:"Ports",validation:"ports","validation-visibility":"live",help:"List of Ports (comma separated, ranges - separated)"}),i(o,{type:"text",name:"vlan",label:"VLAN",validation:"vlan","validation-visibility":"live",help:"List of VLAN ids (comma separated, ranges - separated)"}),i(o,{type:"textarea",rows:"20",name:"ips",label:"IP Addresses",validation:"ips","validation-visibility":"live",help:"List of IP v4 Addresses or CIDR notations (comma separated, ranges - separated)"})]),_:1},8,["modelValue","onSubmit"])}}}),U={key:0},j=m({__name:"recordingForm",setup(l){const{startRecording:t,stopRecording:r}=y(),a=h(null),c=async e=>{const s=await t(e);s!==null?a.value=s:alert(s)},o=async()=>{const e=await r(a.value);e!==null?a.value=null:alert(e)};return(e,s)=>{const n=f("form-kit");return d(),u("div",null,[i(n,{type:"form","submit-label":"Start",onSubmit:c},{default:b(()=>[i(n,{type:"text",name:"size",label:"Max Size",validation:"number","validation-visibility":"live",help:"Max pcap size in MB"}),i(n,{type:"text",name:"duration",label:"Max duration",validation:"number","validation-visibility":"live",help:"Max duration in seconds"})]),_:1}),p(a)!==null?(d(),u("p",U,[L(" Currently Running: "+g(p(a))+" ",1),i(n,{type:"button",label:"Stop Recording",onClick:o})])):w("",!0)])}}}),E={class:"list"},q=["onClick"],G=m({__name:"pcapList",setup(l){const{listRecordings:t}=y(),r=h(""),a=N(()=>r.value.split(`
`).filter(e=>e.endsWith(".pcap"))),c=e=>{const{public:{apiUrl:s}}=B(),n=e.replace(".pcap","");window.open(`${s}/api/recording/download/${n}`)},o=setInterval(async()=>{r.value=await t()},5e3);return V(()=>{clearInterval(o)}),(e,s)=>(d(),u("div",E,[(d(!0),u($,null,F(p(a),n=>(d(),u("div",{class:"item",onClick:()=>c(n)},g(n),9,q))),256))]))}});const H=k(G,[["__scopeId","data-v-b47f5333"]]),C=l=>(A("data-v-c7551019"),l=l(),M(),l),W={class:"actions"},J={class:"flex items-start justify-between gap-4"},K={class:"box w-1/4"},O={class:"box-title"},Q={class:"box w-1/4"},X=C(()=>_("h2",{class:"box-title"}," Start Recording ",-1)),Y={class:"box w-2/4"},Z=C(()=>_("h2",{class:"box-title"}," Downloads ",-1)),ee=m({__name:"index",async setup(l){let t,r;const{generateTraffic:a}=y(),{filter:c,reloadFilter:o}=R();return[t,r]=P(()=>o()),await t,r(),(e,s)=>{const n=f("form-kit"),S=z;return d(),v(S,{name:"page"},{default:b(()=>{var x;return[_("div",W,[i(n,{type:"button",label:"Generate Traffic",onClick:p(a)},null,8,["onClick"]),i(n,{type:"button",label:"Reload Filter",onClick:p(o)},null,8,["onClick"])]),_("div",J,[_("div",K,[_("h2",O," Edit Filter "+g((x=p(c))==null?void 0:x.name),1),p(c)?(d(),v(D,{key:0})):w("",!0)]),_("div",Q,[X,i(j)]),_("div",Y,[Z,i(H)])])]}),_:1})}}});const oe=k(ee,[["__scopeId","data-v-c7551019"]]);export{oe as default};
