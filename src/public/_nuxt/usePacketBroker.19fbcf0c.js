import{p as R,C as d}from"./entry.ca7c75b3.js";const w=()=>{const{public:{apiUrl:n}}=R(),o={"Content-Type":"application/json"};return{get:async(s,t={})=>{const e=new URLSearchParams(t).toString();return await $fetch(`${s}?${e}`,{baseURL:n,headers:o})},post:(s,t={})=>$fetch(s,{method:"POST",baseURL:n,body:t,headers:o}),put:(s,t={})=>$fetch(s,{method:"PUT",baseURL:n,body:t,headers:o}),httpDelete:s=>$fetch(s,{method:"DELETE",baseURL:n,headers:o})}},b=()=>{const{get:n,post:o,put:p}=w(),a=d("filter",()=>null),l=async()=>{var t,e,i,c,u,m,_,f,h,y;try{const r=await n("/api/filter");a.value={name:(r==null?void 0:r.name)||"",description:(r==null?void 0:r.description)||"",ips:((c=(i=(e=(t=r==null?void 0:r.criteria)==null?void 0:t.ipv4_dst)==null?void 0:e[0])==null?void 0:i.addr)==null?void 0:c.join(","))||"",ports:((_=(m=(u=r==null?void 0:r.criteria)==null?void 0:u.layer4_dst_port)==null?void 0:m[0])==null?void 0:_.port)||"",vlan:((y=(h=(f=r==null?void 0:r.criteria)==null?void 0:f.vlan)==null?void 0:h[0])==null?void 0:y.vlan_id)||""}}catch(r){a.value={name:"",description:"",ips:"",ports:"",vlan:""}}};return{filter:a,reloadFilter:l,updateFilter:async t=>{try{if(t.ips||t.ports||t.vlan){const e={mode:"PASS_BY_CRITERIA",criteria:{logical_operation:"AND"}};if(e.criteria&&t.ips){const i=t.ips.split(",").map(c=>c.trim());e.criteria.ipv4_dst=[{addr:i}]}e.criteria&&t.ports&&(e.criteria.layer4_dst_port=[{port:t.ports}]),e.criteria&&t.vlan&&(e.criteria.vlan=[{vlan_id:t.vlan}]),await p("/api/filter",e)}else await p("/api/filter",{mode:"PASS_ALL"});await l()}catch(e){console.error(e)}},measure:async()=>{var t;try{const e=await o("/api/measure"),i=(t=e==null?void 0:e.stats_snapshot)==null?void 0:t[0];return{status:e!==null?"Operational":"Down",passRate:i==null?void 0:i.df_current_pass_rate_bits,time:i==null?void 0:i.stats_time}}catch(e){return console.error(e),{status:"Down",passRate:null,time:null}}}}};export{b as a,w as u};
